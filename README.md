# Changes To Pastel’s Mining System

## *Written on 2/23/24*

![Illustration](https://raw.githubusercontent.com/pastelnetwork/pastels_new_mining_system_explainer/master/mining_system_illustration.webp?token=GHSAT0AAAAAACIQQJOLUOM2PXKUFNBZGQG4ZOZGXNA)

## Introduction

The Pastel Network project has always had Proof-of-Work (“PoW”) mining as a central part of its design, going back to the first Whitepaper in early 2018, where we settled on using Equihash, the “memory hard” PoW algorithm used in the Zcash project. In a sense, PoW was *the* central innovation that made Bitcoin special and allowed it to become the world’s first workable decentralized currency project back in 2008. While many are quick to point out the drawbacks of PoW—bemoaning the large amount of electricity “wasted” on solving “useless math problems”— this line of reasoning typically ignores the many benefits of PoW mining, particularly when it comes to the subject of the provable security properties of the system. 

PoW allows us to have a system of securing the network that offers a level playing field for anyone to contribute as much compute as they want and are able to provide, from the small-time GPU miner using their gaming machine at night to mine on a pool, to the larger scale miner using specialized ASIC machines, without asking anyone for permission. It’s also particularly “fair” in that newly arrived outsider miners have exactly the same chance of mining a block per hash they can compute than insiders to the project who have been here since the beginning, which keeps the system honest. 

For example, if someone decided tomorrow that they wanted to spend a lot of money mining PSL because they liked the project and wanted to acquire a lot of PSL without having to purchase it on the exchanges, then the only way for anyone (including the project founders and the foundation) to prevent this newcomer from acquiring the majority of newly created coins would be for us to step up our *own* expenditures on mining; that is, digging into our pockets to rent hashpower priced in BTC or USDT, for which we don’t have any special “deal” or advantage in acquiring versus anyone else.

This property really comes down to thermodynamics: there is no way to “fake” the compute resources required to mine blocks in a PoW network. While some miners might have access to more power efficient equipment, so that they can compute more hashes using a single kilowatt-hour of electricity, ultimately we all need to use up energy, and no one gets free energy without stealing it (and if they do, they are forgoing potential revenue, since they could instead be selling that electricity to someone else!). 

Proof-of-Stake (“PoS”), however, is most decidedly *not* like that. Not just anyone can start being a validator on Solana, for example. You first need to acquire a lot of SOL coins, and then set up an extremely powerful and expensive machine with a lot of bandwidth (the cost of running such a server on AWS is at least $13,000/month based on [this page from AWS](https://aws.amazon.com/blogs/database/run-solana-nodes-on-aws/) and assuming typical values for data transfer costs, which are actually by far the largest component of the cost!). While no one can buy Solana on an exchange for some special low price— just like no one can get free energy— there are plenty of people who are sitting on lots of SOL that they purchased back when it was going for ~$0.66/SOL back in early 2020 (compared to over $100/sol today in 2024). And those people certainly *do* have a huge advantage in provisioning new Solana validators to increase their influence on the network. More importantly, project insiders, early VC backers, and early “presale” investors received what amounts to a “premine” of over 120 million SOL (out of a total supply today of ~570 million SOL); whatever the average price was to these individuals, it is certainly far, far less than $0.66/SOL!

The point here is that a newcomer to the project really can’t compete on any economic basis with the insiders when it comes to influence on the network. For every new Solana Validator the newcomer could spin up (assuming they had the financial resources to do so), the insiders could spin up 10 more, and have a dramatically lower out-of-pocket cost to do so because of their favored insider status and huge number of extremely low-cost coins. In contrast, Bitcoin is not at all like this. Even if you were mining BTC back in 2009 and now are sitting on 100,000 BTC, you have absolutely no competitive advantage over any other well-capitalized and well-advised miner when it comes to influencing the consensus of the network or in generating new Bitcoins.


## Pastel’s Hybrid Approach

All of the above being said, while Bitcoin is the most secure and decentralized approach from a purely theoretical and perhaps principled basis, it is a lot easier to pull off in the case of Bitcoin because the compute resources required to run a Bitcoin node are pretty modest (you can even use a Raspberry Pi with a big disk to do it; even a slow network connection!). Also, because Bitcoin was the first successful cryptocurrency, and a lot of the early adopters of it are now fabulously wealthy and ideologically driven, there is no shortage of Bitcoin full nodes to run the network, despite miners collecting 100% of the mining block reward and all transaction fees.

Pastel was never going to be able to work on that basis because of its particular requirements: namely, supporting a storage layer and supporting very compute-heavy machine learning workloads (currently just for robust near-duplicate image fingerprinting and detection, but soon for a large variety of ML/AI workloads). The major influence of Pastel’s design for bridging this gap was the Dash project, which really should get more credit for introducing some very powerful and innovative ideas. The main idea that we used from Dash was the concept of a Masternode, although we call these Supernodes (“SNs”) now in Pastel. SNs are full nodes that also require the operator to pledge or lock up a large amount of coin as collateral; in the case of Pastel, you need to send exactly 5 million PSL to an address and keep it there. Of course, anyone can do this without permission, and the technical requirements for Pastel Supernode instances are modest enough that you can meet them with a $35/month cloud server from a value-priced hosting company (they are still much higher than what is required for a Bitcoin full node: 6 CPU cores, 30+ gb of RAM, and 1tb+ of SSD, and this is verified internally by the Pastel software so you can’t fake it). 

In order to incentivize people to acquire and lock up their PSL coins, and to spend the money on running a SN machine, they need to receive some compensation from the network. In the Dash project, they decided to split the mining block reward 50-50 between the PoW miners and the Masternode operators. In a sense, you can think of this as “reducing the security of the network by half in return for the benefits the network gets from having the additional services and reliability made possible by having compensated, dedicated operators running the software.” We believed in this basic “hybrid” PoW/PoS model, but thought the split to the SNs should be more skewed to the PoW miners so that Pastel would give up less security than Dash did. The thinking was that, if PSL is successful, SN operators will easily earn far more than the marginal cost of running their SN instances, so it will be economically sustainable while being more secure. So we settled on a split of 80-20, where 80% of the block reward goes to the PoW miners and 20% goes to the SNs as a group.


## The Need for a Change

So what’s the issue then? Well, we have concluded after operating in this manner for a few years now that the current setup is not particularly sustainable or conducive to the continued healthy development of the Pastel software and network. The problem is really that the benefits of PoW mining are a two-edge sword: while PoW rules out large classes of attacks on the security of the network that come with *all* PoS systems despite what people may claim (this is a larger conversation that isn't directly relevant here, but suffice it to say that [Sybill attacks](https://en.wikipedia.org/wiki/Sybil_attack) are just the top of the iceberg), in a system like Pastel, where the cost of running a SN can’t be ignored as an irrelevant detail the same way running a Bitcoin full node can be (again, because the compute requirements for a Bitcoin full node are low and because there are lots of volunteers willing to run it at their own expense for ideological reasons), they end up leading to what economists call the “[free-rider problem](https://en.wikipedia.org/wiki/Free-rider_problem).” 

In short, people or groups who have no particular interest in the long-term success or health or viability of the Pastel project can simply purchase or rent as much mining hash power as they want, point it at our public mining pools, and mine a very large portion of newly created PSL coins. They can then turn around and simply dump these coins on the market, creating incessant “one way” capital flows which put pressure on the price of PSL and require constant purchases of PSL in the open market to absorb these flows. Moreover, if people do get excited about Pastel’s long term potential and there is a lot of concentrated buying in the market for PSL, sending its price higher in the short term, these “mercenary third party miners” dramatically flex up their mining power to capitalize on the higher price, and then increase the amount of coins they dump on the market. This prevents the price from ever breaking out from a range. It has been frustrating for our long term investors and believers in the project and also for the team building Pastel and our financial backers. 

Meanwhile, the Pastel team and our financial backers must soley meet the very significant cost of developing this complex software with a dedicated team of highly skilled professionals, not to mention the extreme mental effort and energy required to make everything work securely and reliably. And indeed, to prevent the situation from being even worse, the team has been forced to spend large sums of money so that we can internally mine a large portion of newly created coins, just so that we can hold on to these and not have them sold indiscriminately on the market. We’ve also been forced to use a lot of capital that could be better invested in development costs on capitalizing market makers to help provide the financial resources required to absorb the constant market pressure from the third party miners dumping their PSL.

Now, we are very much believers in free markets and capitalism. It would be great if there were so much interest and enthusiasm for PSL from market participants that the actions of these third party miners wouldn’t matter, because all the coins they sold each day (and then some) would be purchased by new interested investors. After all, PSL has quite modest inflation at this point, with the coin supply growing less than 9% each year. To see this, note that the current total supply (not circulating supply, which is much less given the holdings of the Pastel Foundation) of PSL is 14.7B (you can see this easily on the [Pastel Explorer](https://explorer.pastel.network/) site). 

Pastel has a target block time of 2.5 minutes, which means that each day, an average of **(24 x 60)/2.5 = 576** new blocks are mined. The current block reward is 6,250 PSL (5,000 PSL goes to the miner who solved the block, and 1,250 goes to the SNs as a group). Thus the daily issuance of PSL is **576 x 6,250 = 3.6 million PSL**. Thus the annual issuance (before the next "halvening" event, which will happen for PSL around Feb. 8th, 2025, since this occurs every 840,000 PSL blocks, so 840,000 - 637,480 = 202,520 blocks in the future; given Pastel's 2.5 minute average block time, this should take around **(202,520*2.5)/60/24 = 351 days** from today), is **3.6mm x 365 = 1.314 billion PSL per year**, which works out to an inflation rate of **(1.314 / 14.7) = 8.9%**. 

In any case, the reality has not lived up to our hopes and expectations in terms of these market dynamics. Part of this is surely because of the many delays we’ve had in reaching our intended functionality on Pastel’s mainnet, and we certainly take responsibility for these delays and missed opportunities to generate more market interest and demand when the market was particularly bullish. But at this point, we now have a functioning mainnet that does useful things, such as reliable decentralized file storage (Cascade) and robust duplicate image detection (Sense), and we are on the verge of releasing the final versions of various tools and systems that will dramatically increase the real-world utility and accessibility of Pastel’s network. To name a few of these, we have:


- The final release of the Pastel Gateway API, which makes it extremely easy for partners (both companies and other crypto projects) to interface with Pastel’s network using a familiar REST API. While these services would still be ultimately provided by Pastel’s decentralized systems, the users of the Gateway wouldn’t have to think about all that complexity and can call it just as they would call familiar APIs such as those from any other provider such as OpenAI or Cloudflare.
- The integration of Pastel into SmartMint, a consumer targeted web application that makes it easy for anyone to create NFT collections on all popular platforms.
- The release of our new Solana smart contracts that will fully and natively integrate Pastel functionality to Solana users, which can do everything natively on Solana and pay for Pastel services using SOL, without ever needing to think about or deal with PSL (like the Gateway API, these services are still ultimately provisioned using the decentralized Pastel Network, and PSL is required to pay for these services— it’s just that this layer of complexity is hidden from the end user on Solana).
- The dramatic expansion of services that Pastel SNs can offer to users to encompass many kinds of AI model inference tasks for which the inference can be effectively done locally using CPUs and high-RAM instances (this is in the earlier phases still, to be clear).

We don’t want to “waste” these exciting developments because of an unfavorable market dynamic of our own creation; essentially, we’ve been penalized in the crypto market (in terms of the price of PSL) for being too ideologically pure and insisting that our network rely primarily on the most secure and decentralized method of securing a blockchain: PoW. This purity has resulted in lots of coins being mined and dumped by entities that don’t care about making Pastel useful for millions, or in pushing forward the state of the art in blockchain applications. We believe that they are trying to make a quick buck on the back of our work, and would just as soon move on to the next Equihash coin if they thought they could make more money from that.

Again, we still believe in the superiority of PoW from a security standpoint, and don’t see anything inherently wrong in miners pursuing their own self interest. After all, they are providing hash power and using electricity at their own expense which has the result of making Pastel’s blockchain more secure and harder to attack. It’s just that we are acknowledging now that it’s not really working from a practical standpoint: it’s causing us to waste a lot of money and frustrating our investors, and it’s time for a change.


## Our New Model 

With all of that introduction out of the way, let’s finally discuss what we’ve come up with as the solution. First of all, we still believe in PoW, and we are still skeptical of the security and decentralization of pure PoS. Obviously, we are *already* a hybrid PoW/PoS project and have been since the beginning, as explained above. We are going to keep this basic structure in place. The thing that we are changing is something that we have long asked about ourselves, and which many users and investors in the Pastel community have inquired of us: 

*“Is there some way of restricting mining to operators of Pastel SNs?”*

If we could find a good, secure, and reliable way of implementing that concept, it would clearly solve the free-rider problem explained above, since we would no longer have third party miners who could just mine and immediately dump their mined coins on the market, without having any kind of long-term interest or commitment to the Pastel project.  And yet it would still be decentralized, since anyone could still create a Pastel SN without asking for permission and without spending that much in terms of monthly server expenses. But the price of entry would be, at a minimum, the 5 million PSL required as locked-up collateral in order to run a Pastel SN. Given Pastel’s modest inflation rate described above, this would essentially solve the problem of market imbalance caused by miners selling their mined coins, since these sales would be offset by the purchases (or mining) required to obtain the SN collateral PSL.

Not only that, but anyone wishing to mine new PSL would also have to contribute the compute and storage to our network to run the SN. Pastel is designed to fully leverage additional new SNs in the network by scaling horizontally. The more SNs there are, the more machines that can be concurrently processing, storing, and retrieving data on behalf of users. And the more SNs there are, the more robust and redundant the network will become: we can support more tickets per minute, store more data in the storage layer, and decrease the already low probability of catastrophic data loss even further.

Thus, we would turn mining from a overall negative today, since it causes the constant price pressure from free-riders, to a net positive: miners would still be securing the network with PoW based hash power, but they would be forced to reinvest much of the coin proceeds back into the project to acquire the SN collateral they need, while also investing ongoing operating expenses into paying for the cloud computing resources needed to run Pastel SNs. So why didn’t we do this a lot sooner? The short answer is that we never saw a great technological way to do all this in a secure, decentralized, and reliable way. It always seems like too big of a sacrifice of our core principles. It also would require heavy surgery on the very heart of Pastel’s C++ software daemon (called *pasteld*), which we knew would require a huge amount of care and diligence to do correctly.  But the bigger problem was that we simply didn’t know of a good design to do it at all.

That all changed a couple months ago when we figured out an elegant and workable system that we knew we would be able to implement effectively and which could be backwards compatible with the system used up to now. We originally thought it would take us just a few weeks, and while some complications caused it to end up taking us 2 months, we are finally now done with it and it has been working well on our testnet. So what was the big breakthrough idea for how to do this well?

The basic idea is that we simply added two new fields to the block headers for every Pastel block. Like Bitcoin, which Pastel’s design and core implentation is based on, every block has a 140-byte “header” that specifies various important data fields that make the blockchain work. These include fields such as the previous (best) block’s [Merkle root](https://www.investopedia.com/terms/m/merkle-root-cryptocurrency.asp#:~:text=A%20Merkle%20root%20is%20a,whole%2C%20undamaged%2C%20and%20unaltered.), which effectively captures in detail the full history of the blockchain up to that point, and a field for specifying the current difficulty of mining a new block, and other fairly technical details. 

In any case, we added two new fields to the end of this for “version 5” Pastel blocks (the older blocks are all the current “version 4” blocks using the original 140 byte header): the new fields are the PastelID of an active Pastel SN, and the signature of that PastelID on the previous block’s Merkle root. Since that might be confusing, let’s break down what we mean here. We have a system of persistent identity on Pastel, which we refer to as the PastelID. Unlike addresses, which can be generated fresh as needed, making transactions harder to attribute to a particular user of the blockchain, PastelIDs are used on an ongoing basis as the identity of a user on the network. They are established on the network in a totally permission-less way, where users can create their own PastelID “ticket” on the blockchain by sending a small amount of PSL in a certain way to certain addresses that effectively encode the data fields for that PastelID ticket; the user also “burns” some amount of PSL to “activate” the ticket so that others recognize the PastelID as being valid (this is an anti-spam device to prevent users from registering huge numbers of identities at no cost). 

Since the concept of Merkle root is so important in general in blockchains, and particularly for our new mining system, let's take a moment to ensure that we explain what it is. The Merkle root is a single, compact summary of all the transactions in a block of a blockchain. Imagine a tree where every leaf is a transaction. Pairs of these leaves (transactions) are hashed together (a way of turning data into a unique string of characters), and then these hashes are paired and hashed again, and so on, up the tree, until there's just one hash left at the top. This top hash is the Merkle root. This gives us a way to efficiently verify whether a specific transaction is included in a block without needing to check every single transaction individually. If any transaction changes, even slightly, the Merkle root will change too, making it a powerful tool for ensuring data integrity across the blockchain, and for concisely summarizing the entire history of the blockchain in a single short string of characters.


## An Interlude on PastelIDs and Digital Signatures

So what exactly is this PastelID? Well, it’s essentially a public/private keypair using a highly secure digital signature algorithm called Ed448. In that sense, it’s not all that different from a PSL address, which also corresponds to a public/private keypair using a different digital signature algorithm. The upshot here is that users will generally continue to use their PastelIDs to perform operations on the Pastel network and to request services. Indeed, all special services provided by Pastel require a PastelID to access: storing a file in Cascade, registering and checking an image using Sense, etc. And, importantly, every SN that is created on Pastel requires a special kind of PastelID. Again, these PastelIDs are memorialized in the form of blockchain tickets encoded in coin transactions, so they assume all the rigorous security properties and immutability as any other coin transaction on Pastel. You don’t have to worry about a PastelID suddenly changing any more than you have to worry about your PSL coins vanishing from your address.

Because a PastelID is associated with an public and private key, it can be used to sign arbitrary messages. To illustrate, I could create a new SN on Pastel. This would require that I send 5 million PSL to an address, similar to [this](https://explorer.pastel.network/tx/2caafe2e05de8dce2b64cb5aa1062bdf2f901a63e5fdadd027744964c9032228) actual transaction on Pastel that sent the coins to [this](https://explorer.pastel.network/address/PtpNiiEoqbvTDLbhzgMs4RBUgHTt6WQgdfz) address. 
But in addition to this, I would *also* have to register a special PastelID ticket on the blockchain in order to enable that SN so that it will receive its share of block rewards. This ticket would appear in a certain Pastel block, and could be easily inspected by anyone using the Pastel Explorer site for example, as you can [here](https://explorer.pastel.network/pastelid/jXYJaaLSghi1EAGLvwpNkiwtccrhyg8pnnGjZTdyrMYJZAHiUWM6bzCiVxWk8dyWmzjks4HrfY4Lc2i5pSwMeK) for this address (in order to associate the address with the PastelID, you can use *pasteld* commands or simply use our public API [here](https://opennode-fastapi.pastel.network/#/High-Level%20Methods/supernode_data_supernode_data_get)). 

That PastelID can then be used to “sign” data of any kind at all: the data could be a message like `Hi, my name is Bob (2/23/2024)`, or it could be the hash of some file, or anything else. The important thing is that the signature allows anyone at all, without trusting anyone else, to verify that someone who controls the private key associated with that particular PastelID (which they know is a valid PastelID by checking the blockchain) really did sign a particular message. Let’s make this concrete with an example. I can use the following command with *pasteld* to sign a message using a particular PastelID which I control:


    ./pastel-cli pastelid sign "Hi, my name is Bob (2/23/2024)" "jXXTanVUSe1T7n3tPTgY3np9a9ePC7bCHnffGRVjqGLaBxYcANePnTU7AQuEf8QSgH72tda2g4BsxUPNhZBcCB" "passw0rd123" "ed448" 

  
(note that the password part above is just to decrypt the PastelID container file on the local machine; simply knowing that password would not give anyone else access to the PastelID’s private key unless they also had this container file).  

The output of this command for me, since I do have the secret container file on my machine, is as follows:


    {
      "signature": "v+IAwgRZaN2ExKCE+9RRXGRbpqohO0SbZy25HSraRKQbfb49PuBekZ10QAEuWtxxV1lS0g6Kg0KAez9bneb3oYsZasYlhBOys3cLwaGQPMmEcDOZP3a1JrfouAExUIzzdUXVZ6SZzqvLE96JK91pbBAA"
    }

The purpose of all this is that I could then say on Telegram or something, “Hey I control the supernode PastelID [jXXTanVUSe1T7n3tPTgY3np9a9ePC7bCHnffGRVjqGLaBxYcANePnTU7AQuEf8QSgH72tda2g4BsxUPNhZBcCB](https://explorer.pastel.network/pastelid/jXYJaaLSghi1EAGLvwpNkiwtccrhyg8pnnGjZTdyrMYJZAHiUWM6bzCiVxWk8dyWmzjks4HrfY4Lc2i5pSwMeK) and to prove it, I’m going to sign the message "Hi, my name is Bob (2/23/2024)" for you. Here is the signature:


    "v+IAwgRZaN2ExKCE+9RRXGRbpqohO0SbZy25HSraRKQbfb49PuBekZ10QAEuWtxxV1lS0g6Kg0KAez9bneb3oYsZasYlhBOys3cLwaGQPMmEcDOZP3a1JrfouAExUIzzdUXVZ6SZzqvLE96JK91pbBAA"

Now, anyone in that Telegram group, without knowing me or trusting me, can first verify that this PastelID is real and valid (it was mined and included in an actual Pastel block), and that furthermore it is associated with an address that still contains at least 5 million PSL in a single transaction (i.e., the SN collateral). Then they can verify that 1) I really do control that PastelID (because otherwise how would I know the corresponding private key for that PastelID, which is required to sign a message with that PastelID?), and 2) that I really did sign the message “Hi, my name is Bob (2/23/2024)" in a way that I can’t repudiate or deny later without admitting that someone else had access to my secret container file. They would do this simply by running the following command on *their* computer:


    ./pastel-cli pastelid verify "Hi, my name is Bob (2/23/2024)" "v+IAwgRZaN2ExKCE+9RRXGRbpqohO0SbZy25HSraRKQbfb49PuBekZ10QAEuWtxxV1lS0g6Kg0KAez9bneb3oYsZasYlhBOys3cLwaGQPMmEcDOZP3a1JrfouAExUIzzdUXVZ6SZzqvLE96JK91pbBAA" "jXXTanVUSe1T7n3tPTgY3np9a9ePC7bCHnffGRVjqGLaBxYcANePnTU7AQuEf8QSgH72tda2g4BsxUPNhZBcCB" "ed448"

Note that this command did not require the password like the signing command did. *Anyone* can verify a message without any special knowledge required. In any case, anyone in the Telegram group in our example could run the command above and see that the output is:


    {
      "verification": "OK"
    }

So we can see how signatures work, and how we can use them to securely have SN operators use their PastelID identity to attest to a particular message by signing that message with their PastelID private key, and that anyone on the network can then verify that this particular message was signed by this particular PastelID. Note that, in the command above, if any character in the message were changed even slightly, it wouldn’t work:


    ❯ ./pastel-cli pastelid verify "Hey, my name is Bob (2/23/2024)" "v+IAwgRZaN2ExKCE+9RRXGRbpqohO0SbZy25HSraRKQbfb49PuBekZ10QAEuWtxxV1lS0g6Kg0KAez9bneb3oYsZasYlhBOys3cLwaGQPMmEcDOZP3a1JrfouAExUIzzdUXVZ6SZzqvLE96JK91pbBAA" "jXXTanVUSe1T7n3tPTgY3np9a9ePC7bCHnffGRVjqGLaBxYcANePnTU7AQuEf8QSgH72tda2g4BsxUPNhZBcCB" "ed448"
    
    {
      "verification": "Failed"
    }

This use of signing by SN PastelIDs is a critical part of our new mining scheme. Under the new system, it’s not enough to just mine for a solution to a new valid Pastel block by finding a nonce through mining that results in a block hash that meets the difficulty requirements. That block must *also* include the PastelID and valid signature of a Pastel SN that still has their 5 million PSL transaction in their SN’s collateral address. But what message is the PastelID signing? It’s certainly not "Hey, my name is Bob (2/23/2024)"! 

Well, the message that the PastelID is signing is the previous Pastel block’s Merkle root, which explicitly captures the full complexity of the entire Pastel blockchain history up until that point. If even one transaction were changed, or one mined block altered to have a different hash, this Merkle root would change completely. This Merkle root is simply a hash which looks something like `47bbe349f4536e52c480de31f6fce1cd9c1d6455f76a012bf40bb48c13eaa000`. Why did we pick this particular thing as the message that SN operators have to sign using their SN PastelID? Well, it proves that they *just* signed the data, because before the previous block was mined, there is no possible way that anyone could have even know what this Merkle root would be! 

You can’t know what the Merkle root of the previous block is until that block is actually mined. And the PoW mining process generates complete uncertainty because multiple miners are competing to generate winning hashes as quickly as they can, so there is no way to guess or predict what this Merkle root will be. But once it is known, everyone on the network knows it at the same time in a secure, reliable way, since it is directly tied to the precise history of the blockchain that all nodes agree with.

If we picked some other kind of message for SNs to sign, while it would prove that they controlled that PastelID, an attacker could possibly create a Pastel SN with 5 million PSL, use that to create an SN PastelID, and then stockpile a huge number of signatures that they could then use in the future, even if they immediately then shut down their SN and sent the 5 million PSL to an exchange and sold it (actually, even this would be hard to do because other nodes could verify that the associated coins were still in place, but it’s better to completely eliminate the risk). Moreover, the design commits the signing SN to a particular blockchain history and makes it harder to attack the network.


## How This All Comes Together in Our New Mining System

OK, so we added these two new fields to every new Pastel block: the PastelID of an active SN and the signature of this PastelID on the previous block’s Merkle root. In order to mine a new block, you still need to find a winning nonce that results in a block hash that begins with a sufficient number of zeros to meet Pastel’s current mining difficulty requirement, but you must *also* be in possession of an active SN PastelID. Thus, some random miner who just wants to mine and dump PSL like they have been doing for years now, won’t be able to do that. If they want to continue mining, they would first need to lock up 5 million PSL, rent a cloud instance or use their own machine to spin up a Pastel SN, and help run the network. Given the cost and technical requirements of doing that, we believe that most of these third party miners will just switch to easier coins to mine and dump.

But even if they don’t, then we welcome them to the Pastel community, where they will be backing up their interest in our project with an actual commitment of financial resources and ongoing compute and storage contributions to keep the network running. But how does this all work in practice? How does this miner, assuming they are prepared to set up a new Pastel SN, start mining and signing the blocks in the correct way? We came up with two ways of doing this. The first is that every SN from now on will enable at least one CPU thread to operate a CPU miner that will use the PastelID used to set up that particular SN. This is really more of a backup than anything else given the very slow speed of CPU mining versus GPU based mining, let alone ASIC based mining. But it will make the network robust to failures in the few mining pools, since each SN will be able to mine on its own.

Beyond that, we believe the majority of new Pastel blocks will continue to be mined using ASICs via our mining pools, and any pools that anyone else wants to set up for solo mining or public mining. In order to make this all work, we have modified the S-Nomp mining software and in particular, the associated [Stratum Pool library](https://github.com/pastelnetwork/node-stratum-pool-pastel) that it relies upon, to work with our new system. The mining pool already had a password field that we didn’t use (you could put anything as your password and it would work). If you wanted to mine on our pool at [pool.pastel.network](https://pool.pastel.network/),  you simply rented a mining rig on a site like NiceHash or MiningRigRentals (or used your own ASIC miner) and pointed this to our pool site; your “user name” was simply the PSL address where you wanted the pool to send your share of any mined coins based on your contributions to the pool’s overall hash rate relative to other “mining workers” operating on that pool.

We modified the pool software so that anyone who wants to mine Pastel would now also use the password field instead of having it be arbitrary. The new password field would include the IP address of a machine that you set up for this purpose to supply valid SN PastelID signatures on demand for each new block that is mined on Pastel’s blockchain (more about this in a moment) as well as the security token used to access this machine (so that it isn’t open to everyone, just the pool operator, for security purposes; note that even the pool operator can’t do much with that access other than get signatures of your PastelID on the previous Pastel block’s Merkle root; it can’t be used in general to impersonate that PastelID or for anything else). For example, the password field and other mining data might look like this:


        "url" : "stratum+tcp://pool.pastel.network:1234`",
        "user" : "tPehDoxwvxZHGNC3hPSa4aP1yZzRwuSNFkh",
        "pass" : "SuperPassw0rd123|178.18.254.243",

The way this works is that anyone interested in mining can get a cheap cloud instance (or use one they already have, such as an existing instance used for their SN, which they would need to have anyone to run the SN) with a static IP address, and then install our new Python based API server, the [**mining_block_supernode_validator**](https://github.com/pastelnetwork/mining_block_supernode_validator). This is all quite easy to do if you’re technically adept enough already to set up a SN. If all you know how to do is rent hashpower on NiceHash and point it to a pool, and would have no clue at all on how to set up and configure a Pastel SN or this new Python API, then that would be a problem and you’d probably be unable to mine without asking for a lot of help (which of course we’d be happy to provide anyone in our Telegram and Discord groups; remember, the purpose of this is *not* to make mining some exclusive thing available only to anointed insiders or friends; instead, it’s to eliminate the free-rider problem and fix the market dynamics for PSL).

This Python API is pretty straightforward: you simply start it up and it runs in a continuous loop, automatically connecting to the local Pastel node software on that machine so it can monitor new blocks. You simply set up a configuration file that contains the details of your various SN PastelIDs that you want to use for mining. You can use just one if you only have a single SN, or you can use as many as you have (say, 20). This configuration file looks like this:


    all:
      SuperNode01:
        col_address: tPX7gmMjErHz8rMySTn7J1xXiygsRS5jijX
        col_address_pkey: 123
        ind: 0
        other_address: tPWnxyRQ2DZw1TDx1RYGX1y9XpNB4EPDzdC
        other_address_pkey: 123
        pastelid: jXZ6VsP7LkNJE7oSrNRbvYfUHVLFySKeGyDUrTign84UURDohKDXcr49cRRG7fw8gjRxbtLL8ReGHgjfmv7z9y
        pkey: 123
        pwd: passphrase123
        txid: 76a9143e03ee6eb0ac37b9e313fade8932b9f9a69e70ce88ac
      SuperNode02:
        col_address: tPd5qgTjpdJQS48NTPmvG6qYwRch64RFxeF
        col_address_pkey: 123
        ind: 2
        other_address: tPm8AvT1uSfChTczUUxQarnwyKy74xzLopC
        other_address_pkey: 123
        pastelid: jXYs3T1PEe8mNdcLThm3TnVQvzhAxEKdi7gTG2x9EdSfqViwaF3E8T4utvv5LXB9JT7oD1roW4FZVvDp5eDXaM
        pkey: 123
        pwd: passphrase123
        txid: 76a9147f7b4be7dd0f12d11f3fe58aee4360a0b8bd75a088ac

There is also one other config file called `.env` in which you configure the “security token” used to access your machine. You would replace this with some secure password, say one generated using a password manager, and enter it in on the appropriate line (“AUTH_TOKEN”) in the file:


    UVICORN_PORT=9997
    AUTH_TOKEN=SuperPassw0rd123
    SLEEP_SECONDS_BETWEEN_PASTELID_ELIGIBILITY_CHECKS=75

That’s it. You then run the Python API and it spins up a server that listens on port 9997 for requests. In order to access this API, a user must know the secret “security token”. For convenience, the API automatically generates an interactive documentation website that you can check, which looks like this:


![](https://paper-attachments.dropboxusercontent.com/s_D2E0AAF8676B46CAF8157C2741087BFA44BE8382A55DB2FFCB80BFBE2D205018_1708721500749_image.png)


If someone (say, the mining pool operator’s software, which is realistically the only one who would care!) wants to access this, they would click the little lock icon in the upper right, enter `SuperPassw0rd123` in the dialog box, and click the Authorize button:


![](https://paper-attachments.dropboxusercontent.com/s_D2E0AAF8676B46CAF8157C2741087BFA44BE8382A55DB2FFCB80BFBE2D205018_1708721591123_image.png)


At that point, they could simply click the Execute button next to the relevant endpoint and get back a JSON response containing the current signatures for all configured SN PastelIDs applied to the previous block’s Merkle root:


![](https://paper-attachments.dropboxusercontent.com/s_D2E0AAF8676B46CAF8157C2741087BFA44BE8382A55DB2FFCB80BFBE2D205018_1708721650532_image.png)


Of course, the mining pool software would be doing this entirely in an automated way without using a web browser. In this way, the pool can use your SN PastelID signatures to sign new blocks that it finds, *without* you needing to compromise your security by revealing the private keys for those PastelIDs. The private keys stay safe and secure on your server, and the mining pool software can only get the signatures themselves. 


## An Important Caveat

If you’ve been paying close attention and understanding things, you might be wondering something like:

*“Wait a minute, what’s to stop someone from creating just one Pastel SN for under $2,000 as of February 2024 (hopefully this will cost more in the future if the PSL price increases), and then using that one SN to mine as much PSL as they can? You’d end up right back where we are today if those dumping third party miners figure this out.”*

Well, that’s a really good point, and something we thought very carefully about in our new mining system design. Essentially, we don’t simply want it to be enough to just have a single SN in order to mine. What we want is something closer to “If you want to control, say, 20% of the entire Pastel Network hashpower, then you must also control roughly 20% of all the currently active Pastel SNs.” That is, if there are 100 total SNs on Pastel, and you only own one of these, then you should only be able to mine around ~1% of all new blocks on Pastel using that one SN PastelID. And that limit should hold no matter how much actual hash power you have at your disposal; even if you were to go out and rent 50% of all the hashpower on the network at great expense, it wouldn’t help you to mine more Pastel blocks unless you also created additional new SNs. Otherwise, the new system wouldn’t really be able to accomplish our goal of aligning the interests of miners with the rest of the network participants. 

Naively, you might think that you could simply have a rule that, if you had, say, just one SN and the network as a whole had a total of 100 active SNs, that if you just managed to successfully mine a Pastel block using your one SN PastelID, then you shouldn’t be allowed to sign for a new Pastel block until at least 100 new Pastel blocks have been mined since the block you mined. But there are some serious issues with this approach. For one, nothing says that SNs *have to* mine (although the slow CPU miner is enabled by default on a single CPU thread on all SNs by default as explained above) blocks, it is optional. Second, SNs might go down for technical reasons even though their 5 million PSL collateral coins are still in place at the same address; their computer could crash, they could run out of disk space, they could be upgrading their Linux distribution and have to reboot, etc. What would happen if the whole network were sitting around waiting for one of those nodes to use their PastelID to sign the next block?

We solved this problem by instead multiplying the total number of active SNs by 0.75. So in the example above, even if you had just one SN that you controlled, you would be *eligible* to mine a new block after just 75 new blocks had been mined by the rest of the network. This eligibility check has been integrated directly into the *pasteld* software and can be checked using the new command `getminingeligibility`:


![](https://paper-attachments.dropboxusercontent.com/s_D2E0AAF8676B46CAF8157C2741087BFA44BE8382A55DB2FFCB80BFBE2D205018_1708722519210_image.png)


 In this way, all nodes can easily check whether a given SN PastelID, in addition to corresponding to an active SN and being properly registered as a PastelID in a mined blockchain ticket, is currently eligible to use its signature to mine a new block. Now, suppose that all 100 SNs that are active are mining, with most of these using the mining pool with their own rented ASIC miners pointed at the pool so that it’s competitive (of course, some of these SN operators could be running their own mining pools or solo mining). 
 
Since SNs in this example become eligible after just 75 blocks (it’s always 75% time the total number of activated SNs in the network, rounded up to the nearest whole number), there will be 25 SNs at any given time that are eligible to mine the next blocks. And, indeed, all 25 of these SNs would be competing with each other to mine that next block. Suppose 5 of these SNs are controlled by one person who has more hash power in total than anyone else currently mining. Well, that person would have the highest probability of mining the next block, even though it could theoretically be mined using any of those 25 eligible SN PastelIDs; even one using slow CPU mining (although this would be unlikely).
 

## Keeping Mining Competitive

In this way, the system still retains some degree of competition in mining. If two miners both own the same number of SNs, but one miner has twice as much hash power as the other miner, then the one with twice as much hash power *will* mine more blocks on average over time. However, it won’t be twice as much as the other miner, it will be some much smaller percentage, but still enough to be meaningful, especially if the price of PSL is compelling relative to the current mining difficulty, which generally happens when the price of the coin is rising. We believe that it’s absolutely critical to retain this incentive for miners to increase their hash rate, even if it’s a watered down version of this incentive compared to the brutal “zero sum game” nature of mining using the old system.
 
Part of this importance stems from basic security concerns. The higher the total network hash rate, the more secure the network is from double spend attacks and change splits and other problems, even taking into account the need to control SNs in an amount commensurate with your percentage of the total network hash rate. But even beyond that, we intensely rely in the overall design of Pastel on the network hash rate being a rough correlate of the value of PSL. What we mean by this is that, if the price of PSL in dollars were to go up by 5 times, then, all other things being equal, we would roughly expect that the total network hash rate would also go up by a factor of around 5 times, since it would be that much more economical to mine PSL if you could sell the mined coins at the higher price. Sure, maybe there would be a time lag, and maybe the network hash rate and mining difficulty would only go up by 4x (or maybe by 6.5x), but in general, there would be this link between the two quantities as a result of basic market forces and miners individually responding to incentives and profit potential.
 
Why does this matter? Well, all services on Pastel require the payment of fees denominated in PSL. Some of these payments are paid by end users on Pastel to the SNs that provided them with a service (say, storing a file in Cascade or checking an image with Sense), and some of these fees are sent by the end user to an unspendable burn address, thus reducing permanently the total supply of PSL and benefitting everyone else. We’ve set these fees to a level that we think is reasonable and compelling to both end users and to SN operators, taking into account the actual costs of providing these services (remember, storing in Pastel’s storage layer is “forever” for a fixed price, and data is stored in a massively redundant way across many machines) plus a reasonable profit margin to the SN operator. For example, look at [this page](https://explorer.pastel.network/tickets) on the Pastel mainnet Explorer, someone stored a 1.38 megabyte image file at a cost of 2,190 PSL, or $0.76 in dollar terms: 
  

![](https://paper-attachments.dropboxusercontent.com/s_D2E0AAF8676B46CAF8157C2741087BFA44BE8382A55DB2FFCB80BFBE2D205018_1708723491569_image.png)


But what would happen if the price of PSL were to go up by 10x? Would that same image suddenly cost $7.60 to store in Cascade? That’s the exact situation we designed Pastel to avoid, since we saw how it made first Bitcoin and then Ethereum much less viable for various use cases, since the fees were to high relative to the value of the services provided unless the user is working with much larger dollar amounts (you might not care about a $10 transaction fee on Ethereum if you’re sending $70,000 worth of ETH, but you definitely would if you were trying to pay $0.76 for some storage!). The way Pastel’s design avoids this is by having nearly all fees, and especially any variable fees that are based on the total data size (such as file storage in Cascade), dynamically adjust using what we call the “global fee adjustment multiplier.”

The way this works is quite simple and secure, because it never makes reference directly to the price of PSL in dollars or BTC, something that would be very difficult to reliably know in a decentralized way since it is external to the network’s operations and would rely on some third party, such as coinmarketcap or similar to aggregate data from multiple exchanges and produce a single price estimate that everyone agrees on. Instead, the fee adjustment multiplier is based entirely on the measured mining difficulty of the most recent blocks relative to some baseline average period from the past. Since mining difficulty is directly correlated to the overall network hash rate (the system targets an average block time of 2.5 minutes; if blocks are being generate faster than that, say every 1.25 minute on average, then the amount of hash power required on average to mine a new block, called the mining difficulty, would roughly double). This mining difficulty is internal to the network’s operation and is in fact written in the header of every Pastel block, making it very easy and secure for all nodes on the network to agree upon. 

In this indirect way, if the price of PSL were to overnight increase by 10x, then you would expect the total mining hash power on Pastel to also go up by around 10x (even though this might take a few days or even weeks for miners to respond to the increased profit potential), which would in turn cause the mining difficulty to quickly increase by a factor of 10x. And this would have the effect of reducing the price of fees in Pastel, which are denominated in terms of PSL, by a factor of ~90%. To example this, suppose that the the fee before the price increase to store a 7mb PDF file in Cascade was 10,000 PSL, around  $3.47 at the current PSL market price of $0.0003466. 

Now, further suppose that the price of PSL in USD terms increased overnight by 10x (obviously I’m not suggesting this is likely, it’s just for illustrative purposes!). Once the network hash rate and mining difficulty had enough time to adjust to the new market reality by increasing by a roughly similar amount (say for example, by ~8.5x over the next week), then the cost in PSL terms to store that same 7mb file in Cascade the next week would be 10,000 / 8.5 = 1,176 PSL instead. Of course, since the price of PSL in this scenario increased by 10x, to $0.003466, that would work out to a cost in USD of storing the 7mb file in Cascade of 1,176 x $0.003466 = $4.07. So, somewhat more (since we assumed mining difficulty only went up by 8.5x while the PSL price went up by 10x), but basically in the same ballpark and still pretty affordable. Without this dynamic fee adjustment mechanism however, that same file would cost nearly $35 dollars! That quickly gets to the point where it doesn’t make sense to end users. That’s why it’s so important for us to preserve some level of mining competition.


## A Couple Other Technical Wrinkles

What happens in the case where miners were using the pools to mine using their SN PastelIDs and everything is going fine, but then suddenly half of the SNs go down for some reason (say, Amazon’s AWS hosting service had a wide scale outage or similar). If we got unlucky, that 50% of now missing SNs might include *all* of the currently eligible SNs. And since eligibility depends on the number of blocks mined since the last block mined by any particular SN’s PastelID, we could end up in a situation where we simply get stuck without a new block indefinitely! Recall that, under the old system of mining, we didn’t rely on SNs being active at all for mining new blocks; only the miners themselves and mining pools matter for that. 

Another similar situation could arise if the mining difficulty got quite high based on the high power of ASIC miners, but then suddenly image that again half of the SNs suddenly vanish because of some disruption or network issue, and all of the SNs that were using ASICs to mine on pools disappeared from the network at the same time, so that all the remaining SNs are only using the much, much slower CPU based mining. In that case, given the vast difference in the hash rate between a CPU miner and even a weak ASIC, it might be so hard to mine a new block that we are left waiting for hours or even days to mine the next block (once we got the next block, the dynamic difficulty re-targeting would kick back in and dramatically reduce the required mining difficulty to mine a new block, but we could be waiting for a long time for that to happen!).

To deal with both scenarios, we devised an additional mechanism in the mining system. All nodes monitor the time of each new block added to the network. As soon as a new block is mined and accepted by the network, that begins a 15-minute countdown timer. If a new block is mined, say, 3 minutes later, then this timer is then reset again to 15 minutes and resumes counting down from there. But if a new block has *not* been mined in that 15 minute time period (remember, the target block time on average is 2.5 minutes, so we should rarely go 15 minutes without a block by chance alone),  then all nodes enter a special “All SNs are eligible” mode, where they will accept a newly mined block from *any* active SN, even if it’s not currently eligible to mine a block (the signature still has to be correct, and the SN still has to have its 5 million of PSL collateral intact). After that, we go back to the regular eligibility rules.

Believe it or not, the introduction of this special rule introduces yet more special edge cases (this is why it took us 2 months to do all this instead of a few weeks!). In the case where every SN can suddenly mine without restrictions, it dramatically increases the chances that two different SNs will find new blocks at roughly the same time. This can of course cause consensus problems, since some nodes on the network will get the new block from one SN, while other nodes will hear about the other new block from the other SN. Both groups of nodes will think their chain is valid (since the new block is in fact valid), but this will cause a disagreement and a chain split. While we already have automatic mechanisms for dealing with chain splits (the chain that has the most Proof-of-Work on it “wins” and everyone eventually automatically switches to this chain), the splits can still be confusing and disruptive. 

So to avoid this issue, we introduced a 30-second long “aggregation period” as soon as the “every SN is eligible mode” begins, during which time any SN can submit a new valid block. Nodes then looks at the past 10,000 blocks and select the SN that submitted a new valid block as the winner if that SN hasn’t signed a block in the longest time. If only one SN submits a valid block candidate during the 30-second aggregation period, then it wins by default obviously. But if the “10,000 block lookback” process results in a tie between two SNs, then the tie is broken using the SN with higher “seniority” (i.e., the number of minutes since the SN was first created). In general, whenever there is ambiguity about which SN mined a block, we can use this SN seniority as a tie-breaker to settle things in a fair, straightforward, and decentralized manner.


## In Actual Practice

The purpose of this rather long and detailed article is to explain our reasoning and principled rationale behind this fairly major change to the way mining and consensus works in Pastel. We explained the problems we were trying to address and why we think we found a good solution, and then went into the nitty gritty details of how we implemented everything so that we are completely transparent about everything. However, from the perspective of most PSL users, the actual details aren’t so important. The main takeaway is that there will be a lot less mining and dumping from parties that do not care about the project and don’t want to invest or help with the long term success of the network. 

From the perspective of miners of Pastel, you also don’t really need to understand all the intricacies of the new design. You just have to figure out if you want to set up some SNs to continue mining, and whether you think it makes sense for you to do so given the new requirement for an up-front investment for the SN collateral and for the ongoing expense of running the SN machines and supernode mining block validator API, which is of course on top of the cost of the rented hashpower or capital/electricity costs of mining. We hope you will conclude that it is worth it, and we stand ready to assist you in setting up your SNs and the new Python API discussed above. We will also make sure that our public mining pool remains stable and available for use with your instance of the Python API, so that “outsiders” are not at all disadvantaged when it comes to their ability to mine under the new system.

So how are we going to handle the process of actually switching over? First, we are doing more rigorous experiments for the next few days on our Pastel Testnet, to simulate various strange edge cases and sudden changes in the number of SNs mining, changes in which and how many SNs mine via an ASIC on the pool versus independently using CPU mining, etc. Then, we obviously want to give exchanges time to upgrade to avoid disruptions, and we also want to give existing miners or potential new miners the chance to ask us about questions they have and time to set up any new SN instances and the new Python API server for their SNs. Because the change to the mining system is necessarily a complete break in compatibility for all Pastel Nodes operating on the network (not just SNs, but any node, such as in our user wallet software, in the nodes the exchanges run, in the Explorer, OpennodeFastapi, Gateway, RestRPCServer instances, etc.), we will increment the so-called "protocol number," which will prevent nodes running the obsolete software from even connecting to the network. Instead, they will see a message telling them that must upgrade their node software. This will avoid all sorts of problems that could arise from having some nodes on the network running the old software and some running the new software, and will also make it easier for us to monitor the upgrade process and make sure that everyone is on the same page. For user who use our graphical wallet software, the wallet should automatically handle the upgrade process for you. For those who use the command line wallet, you will need to download the new software from our GitHub release page, or from our [download page](https://download.pastel.network/#latest-release/mainnet/pasteld/), and then replace the old binaries with the new ones and restart. Once we know that all connected nodes are running the new version of the software, we will set some block height (say, a week after the protocol change goes into effect) at which point the new mining system will be activated. We will then monitor the network for a few days to make sure that everything is working as expected, and then we will declare the new mining system to be fully operational. We will also be carefully monitoring the realized network hash rate and mining difficulty for changes so that we can clearly quantify the impact of this change. We will also be closely watching the underlying market dynamics for PSL to see how the new system impacts the price and volume on the exchanges.


## A Bright Future Ahead

We are very optimistic about the future of Pastel. As mentioned earlier, we have so much great and useful functionality coming in the pipeline, and our long term roadmap has never looked bright given the newfound importance of local AI inference applications. We believe we are very well positioned by virtue of our unusual and innovative technical architecture to really capture this opportunity. We have the most advanced and robust decentralized file storage layer in the world. We have the ability to do compute-intensive and RAM-intensive local AI workloads extremely competitively (after all, these servers are already sitting around waiting to do more useful work, so let’s put them to work!). And soon, with the introduction of our comprehensive Solana integrations (with other blockchain integrations coming after that), we will no longer be a “crypto island” that is disconnected from the rest of the ecosystem.

The only thing we’ve been concerned about is the market backdrop, and in particular, the specific negative market dynamics we’ve seen in the PSL price from these unaligned third party miners. That’s why we took a significant amount of time and energy away from our other development efforts to solve this problem once and for all in a rigorous and technically elegant way that doesn’t sacrifice our principles or the security and viability of the network over the long term. We would not have pressed forward with this new mining system unless we felt confident that the network would still be totally decentralized, secure, and censorship resistant after the change. We don’t just pay lip service to these ideals, but really try to live these principles, even when it requires a huge amount of additional technical work by us to make it all possible.

Creating this new system was not easy. In addition to the [extensive changes](https://github.com/pastelnetwork/pastel/tree/PSL-1098) we had to make in the core Pastel C++ project and inside the S-Nomp [mining pool software](https://github.com/pastelnetwork/s-nomp-pastel) and associated [Stratum Pool library](https://github.com/pastelnetwork/node-stratum-pool-pastel) (including updating these very outdated projects from NodeJS version 8 to the current 20.1 LTS version!), we also had to write a new Python API server from scratch using FastAPI (luckily, this was the easy part!). And we didn't even mention above that we also had to replace an older and less reliable Equihash solution verification library (which had documented problems with accepting invalid hashes from some miners, which could make our mining pool unfair if exploited) with an [all new NodeJS library called equihash-node-binding](https://github.com/pastelnetwork/equihash-node-binding) that we created using a more reliable and correct [Rust implementation of Equihash](https://docs.rs/equihash/latest/equihash/)). Or, that to make the new mining pool software more performant and reliable, we created a completely new and generally useful [NodeJS library](https://github.com/pastelnetwork/pastel_nodejs_client) that makes it very easy to work with the Pastel node software (any command that you can do using `pastel-cli` on the command line can now be done easily in a high performance, fully async JS library [hosted on npm](https://www.npmjs.com/package/pastel_nodejs_client) for convenience), which should be of great utility for future projects, both by us and by our partners. 

Making sure that the mining pool results were exactly compatible with the internal CPU mining code in the Pastel node software was a very significant challenge, requiring several very long days of painstaking debugging and testing to get everything working correctly. Fortunately, this served as an extremely rigorous check on everything and helped us identify and fix bugs in both the pool implementation and within the Pastel node software. Importantly, we made sure that the process of verifying the eligibility of each mining share submitted to the mining pool software followed the *exact* same process that is applied by the Pastel node software internally when it does CPU mining, so that we could be sure that the mining pool always treated mining workers in the pool in a fair and correct way— never giving them credit for shares that were not actually eligible to mine a new block, which would be unfair to those workers which did have eligible PastelIDs and would also undermine the strict link we want between SN ownership and mining hash rate by individual miners.

That is all to say, this stuff is hard and requires a lot of work to get right, but we are very proud of the results and believe that we have created a system that will be very effective at aligning the interests of miners with the rest of the network participants. We are excited to see how the new mining system works in practice, particularly on how it will impact market dynamics for PSL. We are also excited and relieved to get back to our other pressing development work, so that we can continue to make Pastel the best and most useful decentralized platform in the world. We are very grateful to all of our community members who have been so supportive and patient with us as we worked through the many hard technical challenges of the past couple years. We believe that the wait will prove to be worth it, both for users and investors. Thanks for taking the time to read this rather long and demanding article. As always, we are happy to answer any questions you might have about this or any other topic, so please don’t hesitate to reach out to us in our Telegram or Discord groups. Thanks again for your attention, and we hope you learned something useful about blockchains, mining, crypto-economics, cryptography, and most importantly, about Pastel!
